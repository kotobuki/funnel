package {	import flash.display.Sprite;	import flash.events.Event;	import flash.utils.getTimer;	import funnel.*;	import funnel.gui.OnScreenController;	import funnel.i2c.*;	/**	 * HMC6352コンパスモジュールの方向情報を表示する。	 * Display heading values of a HMC6352 compass module.	 *	 * <p>準備<ol>	 * <li>HMC6352コンパスモジュールを接続する</li>	 * <li>hardware/arduino/SimpleI2CFirmataをArduinoにアップロードする</li>	 * </ol></p>	 *	 * <p>Preparation<ol>	 * <li>Connect a HMC6352 compass module to the Arduino</li>	 * <li>upload hardware/arduino/SimpleI2CFirmata to the Arduino</li>	 * </ol></p>	 */	public class ArduinoI2CTestNunchuck extends Sprite {		private var aio:Arduino;		private var nunchuck:WiiNunchuck;		private var joystickX:OnScreenController;		private var joystickY:OnScreenController;		private var accelX:OnScreenController;		private var accelY:OnScreenController;		private var accelZ:OnScreenController;		private var zButton:OnScreenController;		private var cButton:OnScreenController;		public function ArduinoI2CTestNunchuck() {			var config:Configuration = Arduino.FIRMATA;			config.enablePowerPins();			aio = new Arduino(config);			aio.addEventListener(FunnelEvent.I2C_POWER_PINS_READY, onI2CPowerPinsReady);			createGUI();		}		private function onI2CPowerPinsReady(event:Event):void {			nunchuck = new WiiNunchuck(aio);			nunchuck.addEventListener(Event.CHANGE, onChange);			addEventListener(Event.ENTER_FRAME, loop);		}		private function loop(event:Event):void {		}		private function onChange(e:Event):void {			joystickX.value = nunchuck.joystickX;			joystickY.value = nunchuck.joystickY;			accelX.value = nunchuck.x;			accelY.value = nunchuck.y;			accelZ.value = nunchuck.z;			cButton.value = nunchuck.cButton;			zButton.value = nunchuck.zButton;		}		private function createGUI():void {			joystickX = new OnScreenController("Joy X", 128, OnScreenController.ANALOG, false, -1, 1);			joystickX.y = 0;			addChild(joystickX);			joystickY = new OnScreenController("Joy Y", 128, OnScreenController.ANALOG, false, -1, 1);			joystickY.y = 20;			addChild(joystickY);			accelX = new OnScreenController("Accel X", 128, OnScreenController.ANALOG, false, -1, 1);			accelX.y = 40;			addChild(accelX);			accelY = new OnScreenController("Accel Y", 128, OnScreenController.ANALOG, false, -1, 1);			accelY.y = 60;			addChild(accelY);			accelZ = new OnScreenController("Accel Z", 128, OnScreenController.ANALOG, false, -1, 1);			accelZ.y = 80;			addChild(accelZ);			cButton = new OnScreenController("C", 58, OnScreenController.DIGITAL_TOGGLE, false);			cButton.y = 100;			addChild(cButton);			zButton = new OnScreenController("Z", 58, OnScreenController.DIGITAL_TOGGLE, false);			zButton.y = 120;			addChild(zButton);		}	}}