package funnel.ui {	import funnel.*;	/**	 * Created 17 May 2009	 * By Shigeru Kobayashi	 * This is the class to express a LED	 * 	 * Reference	 * http://www.switch-science.com/trac/wiki/BD62xx-Basic	 */	public class HBridge {		private var _forwardPin:Pin;		private var _reversePin:Pin;		private var _value:Number = 0;		private var _offset:Number = 0;		private var _range:Number = 0;		public function HBridge(forwardPin:Pin, reversePin:Pin, minimumVoltage:Number = 1, maximumVoltage:Number = 1.5, supplyVoltage:Number = 5) {			_forwardPin = forwardPin;			_reversePin = reversePin;			_offset = minimumVoltage / supplyVoltage;			_range = (maximumVoltage - minimumVoltage) / supplyVoltage;			trace("offset: " + _offset);			trace("range: " + _range);			standby();		}		public function get value():Number {			return _value;		}		public function set value(val:Number):void {			_value = Math.max(-1, Math.min(1, val));			if (val > 0) {				forward(_value);			} else if (val < 0) {				reverse(-_value)			} else {				brake();			}		}		public function standby():void {			_forwardPin.value = 0;			_reversePin.value = 0;			_value = 0;		}		public function brake():void {			_forwardPin.value = 1;			_reversePin.value = 1;			_value = 0;		}		public function forward(val:Number = 1):void {			_value = Math.max(0, Math.min(1, val));			_forwardPin.value = val * _range + _offset;			_reversePin.value = 0;			_value = val;		}		public function reverse(val:Number = 1):void {			_value = Math.max(0, Math.min(1, val));			_forwardPin.value = 0;			_reversePin.value = _offset - val * _range;			_value = -1 * val;		}	}}